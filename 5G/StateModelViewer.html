<!DOCTYPE html>
<html>

	<head>
		<script src=
			"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js">
		</script>
		<script src=
			"https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js">
		</script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
		<link rel="stylesheet" href=
			"https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css">
		<link rel="stylesheet"
			type="text/css" href=
			"https://use.fontawesome.com/releases/v5.6.3/css/all.css">

		<link rel="stylesheet"
			type="text/css" href=
			"toggle_switch.css">

		<script type="text/javascript">
			function showHideRow(row, cb, sec) {
				$("#" + row).toggle();
				$("#" + cb).toggle();
				$("#" + sec).toggle();

				$('body').append('<div style="" id="loadingDiv"><div class="loader"> <p style="margin-top:30px; color:red;" >Loading... </p></div></div>'); //link: https://stackoverflow.com/questions/1853662/how-to-show-page-loading-div-until-the-page-has-finished-loading
				setTimeout(removeLoader, 100); //wait for page load PLUS two seconds.
			}

			
			function removeLoader(){
			    $( "#loadingDiv" ).fadeOut(500, function() {
			      // fadeOut complete. Remove the loading div
			      $( "#loadingDiv" ).remove(); //makes page more lightweight 
			  });  
			}
		</script>

		<style>

			path.link {
	          fill: none;
	          stroke: #666;
	          stroke-width: 1.5px;
	        }

	        circle {
	          fill: #ccc;
	          stroke: #fff;
	          stroke-width: 1.5px;
	        }

	        text {
	          fill: #000;
	          font: 10px sans-serif;
	          pointer-events: none;
	        }
			body {
				margin: 0 auto;
				padding: 0px;
				text-align: center;
				width: 100%;
				font-family: "Myriad Pro",
					"Helvetica Neue", Helvetica,
					Arial, Sans-Serif;
			}

			.div1, .div2{

				float: left;
				width: 80%;
				height: 20%;
				box-sizing: border-box;
/*				border: 3px solid rgb(0, 0, 0);*/

				}

			#wrapper {
				margin: 0 auto;
				margin-top: 50px;
				margin-bottom: 100px;
				padding: -5px;
				text-align: center;
				width: 1400px;

			}

			#wrapper h1 {
				margin-top: -5px;
				font-size: 45px;
				color: #585858;
			}

			#wrapper h1 p {
				font-size: 20px;
			}

			#table_detail {
				width: 900px;
				text-align: left;
				border-collapse: collapse;
				color: #2E2E2E;
				border: #A4A4A4;
				margin-bottom: 10px;
			}

			#table_detail tr:hover {
				background-color: #F2F2F2;
			}

			#table_detail .hidden_row {
				display: none;
			}

			h3,h4{
				text-align: left;
				margin-left: 200px;
			}

			


		.loader,
        .loader:after {
            border-radius: 50%;
            width: 10em;
            height: 10em;
        }
        .loader {            
            border: 16px solid #f3f3f3; /* Light grey */
			  border-top: 16px solid #3498db; /* Blue */
			  border-radius: 100%;
			  width: 120px;
			  height: 120px;
			  animation: spin 2s linear infinite;
        }
        
        @keyframes load8 {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
        #loadingDiv {
            position:absolute;;
            top:0;
            left:0;
            width:100%;
            height:100%;
            background-color:#020;
            opacity: 0.5;
        }




		</style>
	</head>

	<body>
		<!-- <div class="parent"> -->
		
			<div id="wrapper" class="div1">

				<h1 align="center"> State Model Viewer </h1>

				<h3> Please select a control to view the details </h3> 


				<table border=1 id="table_detail"
					align=center cellpadding=10>

					<tr>
						<th>Is Selected</th>
						<th>ID</th>
						<th>Title</th>
						<th>Description</th>
					</tr>

					<tr onclick="showHideRow('hidden_row1', 'id_cb_cntrl_1', 'div1');">
						<td><input type="checkbox" id="id_cb_cntrl_1" checked class="hidden_row"/>&nbsp;</td>
						<td>AC-6</td>
						<td>Least Privilege</td>
						<td>Prevent non-privileged users from executing privileged functions</td>
					</tr>
					<tr id="hidden_row1" class="hidden_row">
						<td colspan=4>
							<b>Details with Keywords</b>: Privileged functions include disabling, circumventing, or altering implemented security or privacy controls, establishing system accounts, performing system integrity checks, and administering cryptographic key management activities. Non-privileged users are individuals who do not possess appropriate authorizations. Privileged functions that require protection from non-privileged users include circumventing intrusion detection and prevention mechanisms or malicious code protection mechanisms. Preventing non-privileged users from executing privileged functions is enforced by AC-3.
							<br>

						</td>
					</tr>

					<tr onclick="showHideRow('hidden_row2', 'id_cb_cntrl_2');">
						<td><input type="checkbox" id="id_cb_cntrl_2" checked class="hidden_row"/>&nbsp;</td>
						<td>AC-7</td>
						<td>Unsuccessful Logon Attempts</td>
						<td>Enforce a limit of consecutive invalid logon attempts by a user during an organization-defined time period and automatically lock the account or node for an organization-defined time period; delay next logon prompt per; notify system administrator; etc.</td>
					</tr>
					<tr id="hidden_row2" class="hidden_row">
						<td colspan=4>
							<b>Details with Keywords</b>: The need to limit unsuccessful logon attempts and take subsequent action when the maximum number of attempts is exceeded applies regardless of whether the logon occurs via a local or network connection. Due to the potential for denial of service, automatic lockouts initiated by systems are usually temporary and automatically release after a predetermined, organization-defined time period. If a delay algorithm is selected, organizations may employ different algorithms for different components of the system based on the capabilities of those components. Responses to unsuccessful logon attempts may be implemented at the operating system and the application levels. Organization-defined actions that may be taken when the number of allowed consecutive invalid logon attempts is exceeded include prompting the user to answer a secret question in addition to the username and password, invoking a lockdown mode with limited user capabilities (instead of full lockout), allowing users to only logon from specified Internet Protocol (IP) addresses, requiring a CAPTCHA to prevent automated attacks, or applying user profiles such as location, time of day, IP address, device, or Media Access Control (MAC) address. If automatic system lockout or execution of a delay algorithm is not implemented in support of the availability objective, organizations consider a combination of other actions to help prevent brute force attacks. In addition to the above, organizations can prompt users to respond to a secret question before the number of allowed unsuccessful logon attempts is exceeded. Automatically unlocking an account after a specified period of time is generally not permitted. However, exceptions may be required based on operational mission or need.
						</td>
					</tr>

					<tr onclick="showHideRow('hidden_row3', 'id_cb_cntrl_3');">
						<td><input type="checkbox" id="id_cb_cntrl_3" checked class="hidden_row"/>&nbsp;</td>
						<td>CM-7</td>
						<td>Periodic Review</td>
						<td>Review the system to identify unnecessary and/or nonsecure functions, ports, protocols, software, and services</td>
					</tr>
					<tr id="hidden_row3" class="hidden_row">
						<td colspan=4>
							<b>Details with Keywords</b>: Organizations review functions, ports, protocols, and services provided by systems or system components to determine the functions and services that are candidates for elimination. Such reviews are especially important during transition periods from older technologies to newer technologies (e.g., transition from IPv4 to IPv6). These technology transitions may require implementing the older and newer technologies simultaneously during the transition period and returning to minimum essential functions, ports, protocols, and services at the earliest opportunity. Organizations can either decide the relative security of the function, port, protocol, and/or service or base the security decision on the assessment of other entities. Unsecure protocols include Bluetooth, FTP, and peer-to-peer networking.
						</td>
					</tr>

					<tr onclick="showHideRow('hidden_row4', 'id_cb_cntrl_4');">
						<td><input type="checkbox" id="id_cb_cntrl_4" checked class="hidden_row"/>&nbsp;</td>
						<td>SI-4</td>
						<td>Automated System Monitoring</td>
						<td>Employ automated tools and mechanisms to support near real-time analysis of events.</td>
					</tr>
					<tr id="hidden_row4" class="hidden_row">
						<td colspan=4>
							<b>Details with Keywords</b>: Automated tools and mechanisms include host-based, network-based, transport-based, or storage-based event monitoring tools and mechanisms or security information and event management (SIEM) technologies that provide real-time analysis of alerts and notifications generated by organizational systems. Automated monitoring techniques can create unintended privacy risks because automated controls may connect to external or otherwise unrelated systems. The matching of records between these systems may create linkages with unintended consequences. Organizations assess and document these risks in their privacy impact assessment and make determinations that are in alignment with their privacy program plan.
						</td>
					</tr>

				</table>

				<br>

				<div class="hidden_row" id="div1">
					<h3> Exctracted Keywords: </h3> 
						
					<fieldset class="multiswitch" style="margin-left: 480px; margin-top: -38px;"> 
					  <div class="slide-container">
					    <input type="radio" name="account" id="account1" checked>
					    <label for="account1">Top 5</label>
					    <input type="radio" name="account" id="account2">
					    <label for="account2">To5 10</label>
					    <input type="radio" name="account" id="account3">
					    <label for="account3">Top 15</label>
					    <!-- leave this "slide" -->
					    <a class="slide" aria-hidden="true"></a>
					  </div>
					</fieldset>
					<table border=2 id="table_detail"
						align=center cellpadding=5>

						<tr>
							<td> LogOn, Invalid LogOn, System Administarator, Unauthorized logon </th>
						</tr>
					</table>

					<br>

					<h3> Pre-condition of the breached control: </h3> 
						
					<fieldset class="multiswitch" data-theme="stoplight" style="margin-left: 680px; margin-top: -38px;"> 
					  <div class="slide-container">
					    <input type="radio" name="stoplight" id="stoplight1" checked>
					    <label for="stoplight1">Top 5</label>
					    <input type="radio" name="stoplight" id="stoplight2">
					    <label for="stoplight2">To5 10</label>
					    <input type="radio" name="stoplight" id="stoplight3">
					    <label for="stoplight3">Top 15</label>
					    <!-- leave this "slide" -->
					    <a class="slide" aria-hidden="true"></a>
					  </div>
					</fieldset>


					<table border=1 id="table_detail"
						align=center cellpadding=10>

						<tr>
							<th>Is Selected</th>
							<th>ID</th>
							<th>Title</th>
							<th>Description</th>
						</tr>

						<tr onclick="showHideRow('pre_cond_hidden_row1', 'id_cb_T1134');">
							<td><input type="checkbox" id="id_cb_T1134" checked class="hidden_row"/>&nbsp;</td>
							<td>T1134</td>
							<td>Access Token Manipulation</td>
							<td>Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls</td>
						</tr>
						<tr id="pre_cond_hidden_row1" class="hidden_row">
							<td colspan=4>
								<b>Detail Description</b>: Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls. Windows uses access tokens to determine the ownership of a running process. A user can manipulate access tokens to make a running process appear as though it is the child of a different process or belongs to someone other than the user that started the process. When this occurs, the process also takes on the security context associated with the new token.
								<br>
								An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. These token can then be applied to an existing process (i.e. [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001)) or used to spawn a new process (i.e. [Create Process with Token](https://attack.mitre.org/techniques/T1134/002)). An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can then use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system.(Citation: Pentestlab Token Manipulation)

								<br>
								Any standard user can use the <code>runas</code> command, and the Windows API functions, to create impersonation tokens; it does not require access to an administrator account. There are also other mechanisms, such as Active Directory fields, that can be used to modify access tokens.
								<br>

							</td>
						</tr>

						<tr onclick="showHideRow('pre_cond_hidden_row2', 'id_cb_T1110');">
							<td><input type="checkbox" id="id_cb_T1110" checked class="hidden_row"/>&nbsp;</td>
							<td>T1110.002</td>
							<td>Brute Force: Password Cracking</td>
							<td>Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained.</td>
						</tr>
						<tr id="pre_cond_hidden_row2" class="hidden_row">
							<td colspan=4>
								<b>Detail Description</b>: Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained. [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) can be used to obtain password hashes, this may only get an adversary so far when [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) is not an option. Further,  adversaries may leverage [Data from Configuration Repository](https://attack.mitre.org/techniques/T1602) in order to obtain hashed credentials for network devices.(Citation: US-CERT-TA18-106A) <br><br>

								Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network.(Citation: Wikipedia Password cracking) The resulting plaintext password resulting from a successfully cracked hash may be used to log into systems, resources, and services in which the account has access.
							</td>
						</tr>

						<tr onclick="showHideRow('pre_cond_hidden_row3', 'id_cb_T1567');">
							<td><input type="checkbox" id="id_cb_T1567" checked class="hidden_row"/>&nbsp;</td>
							<td>T1567</td>
							<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage</td>
							<td>Adversaries may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel.</td>
						</tr>
						<tr id="pre_cond_hidden_row3" class="hidden_row">
							<td colspan=4>
								<b>Detail Description</b>: Adversaries may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel. Popular Web services acting as an exfiltration mechanism may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to compromise. Firewall rules may also already exist to permit traffic to these services.

								<br>Web service providers also commonly use SSL/TLS encryption, giving adversaries an added level of protection.
							</td>
						</tr>

					</table>

					<label>Not seeing the relevant pre-conditions?</label> <button>Please add</button>

						<br><br>
					<h3> Post-condition of the breached control: </h3> 
					<fieldset class="multiswitch" data-theme="stoplight" style="margin-left: 680px; margin-top: -38px;"> 
					  <div class="slide-container">
					    <input type="radio" id="id_rb_post_cond_top_5" checked>
					    <label for="id_rb_post_cond_top_5">Top 5</label>
					    <input type="radio"  id="id_rb_post_cond_top_10">
					    <label for="id_rb_post_cond_top_10">To5 10</label>
					    <input type="radio"  id="id_rb_post_cond_top_15">
					    <label for="id_rb_post_cond_top_15">Top 15</label>
					    <!-- leave this "slide" -->
					    <a class="slide" aria-hidden="true"></a>
					  </div>
					</fieldset>	

					<table border=1 id="table_detail"
						align=center cellpadding=10>

						<tr>
							<th>Is Selected</th>
							<th>ID</th>
							<th>Title</th>
							<th>Description</th>
						</tr>

						<tr onclick="showHideRow('post_cond_hidden_row1', 'id_cb_T011');">
							<td><input type="checkbox" id="id_cb_T011" checked class="hidden_row"/>&nbsp;</td>
							<td>T11</td>
							<td>Access Token Manipulation</td>
							<td>Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls</td>
						</tr>
						<tr id="post_cond_hidden_row1" class="hidden_row">
							<td colspan=4>
								<b>Detail Description</b>: Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls. Windows uses access tokens to determine the ownership of a running process. A user can manipulate access tokens to make a running process appear as though it is the child of a different process or belongs to someone other than the user that started the process. When this occurs, the process also takes on the security context associated with the new token.
								<br>
								An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. These token can then be applied to an existing process (i.e. [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001)) or used to spawn a new process (i.e. [Create Process with Token](https://attack.mitre.org/techniques/T1134/002)). An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can then use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system.(Citation: Pentestlab Token Manipulation)

								<br>
								Any standard user can use the <code>runas</code> command, and the Windows API functions, to create impersonation tokens; it does not require access to an administrator account. There are also other mechanisms, such as Active Directory fields, that can be used to modify access tokens.
								<br>

							</td>
						</tr>

						<tr onclick="showHideRow('post_cond_hidden_row2', 'id_cb_T111');">
							<td><input type="checkbox" id="id_cb_T111" checked class="hidden_row"/>&nbsp;</td>
							<td>T111</td>
							<td>Brute Force: Password Cracking</td>
							<td>Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained.</td>
						</tr>
						<tr id="post_cond_hidden_row2" class="hidden_row">
							<td colspan=4>
								<b>Detail Description</b>: Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained. [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) can be used to obtain password hashes, this may only get an adversary so far when [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) is not an option. Further,  adversaries may leverage [Data from Configuration Repository](https://attack.mitre.org/techniques/T1602) in order to obtain hashed credentials for network devices.(Citation: US-CERT-TA18-106A) <br><br>

								Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network.(Citation: Wikipedia Password cracking) The resulting plaintext password resulting from a successfully cracked hash may be used to log into systems, resources, and services in which the account has access.
							</td>
						</tr>

						<tr onclick="showHideRow('post_cond_hidden_row3', 'id_cb_T156');">
							<td><input type="checkbox" id="id_cb_T156" checked class="hidden_row"/>&nbsp;</td>
							<td>T156</td>
							<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage</td>
							<td>Adversaries may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel.</td>
						</tr>
						<tr id="post_cond_hidden_row3" class="hidden_row">
							<td colspan=4>
								<b>Detail Description</b>: Adversaries may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel. Popular Web services acting as an exfiltration mechanism may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to compromise. Firewall rules may also already exist to permit traffic to these services.

								<br>Web service providers also commonly use SSL/TLS encryption, giving adversaries an added level of protection.
							</td>
						</tr>

					</table>
					<label>Not seeing the relevant post-conditions?</label> <button id="btn_add_post_condition">Please add</button>
				</div>	
			</div>

			<button>Save the model</button>

			<br><br><br>


			<div class="div2">
	            Generated Graph
		        <script>

		            // get the data
		            d3.csv("force.csv", function(error, links) {

		            var nodes = {};

		            // Compute the distinct nodes from the links.
		            links.forEach(function(link) {
		                link.source = nodes[link.source] || 
		                    (nodes[link.source] = {name: link.source});
		                link.target = nodes[link.target] || 
		                    (nodes[link.target] = {name: link.target});
		                link.value = +link.value;
		            });

		            var width = 960,
		                height = 500;

		            var force = d3.layout.force()
		                .nodes(d3.values(nodes))
		                .links(links)
		                .size([width, height])
		                .linkDistance(60)
		                .charge(-300)
		                .on("tick", tick)
		                .start();

		            var svg = d3.select("body").append("svg")
		                .attr("width", width)
		                .attr("height", height);

		            // build the arrow.
		            svg.append("svg:defs").selectAll("marker")
		                .data(["end"])      // Different link/path types can be defined here
		              .enter().append("svg:marker")    // This section adds in the arrows
		                .attr("id", String)
		                .attr("viewBox", "0 -5 10 10")
		                .attr("refX", 15)
		                .attr("refY", -1.5)
		                .attr("markerWidth", 6)
		                .attr("markerHeight", 6)
		                .attr("orient", "auto")
		              .append("svg:path")
		                .attr("d", "M0,-5L10,0L0,5");

		            // add the links and the arrows
		            var path = svg.append("svg:g").selectAll("path")
		                .data(force.links())
		              .enter().append("svg:path")
		            //    .attr("class", function(d) { return "link " + d.type; })
		                .attr("class", "link")
		                .attr("marker-end", "url(#end)");

		            // define the nodes
		            var node = svg.selectAll(".node")
		                .data(force.nodes())
		              .enter().append("g")
		                .attr("class", "node")
		                .call(force.drag);

		            // add the nodes
		            node.append("circle")
		                .attr("r", 5);

		            // add the text 
		            node.append("text")
		                .attr("x", 12)
		                .attr("dy", ".35em")
		                .text(function(d) { return d.name; });

		            // add the curvy lines
		            function tick() {
		                path.attr("d", function(d) {
		                    var dx = d.target.x - d.source.x,
		                        dy = d.target.y - d.source.y,
		                        dr = Math.sqrt(dx * dx + dy * dy);
		                    return "M" + 
		                        d.source.x + "," + 
		                        d.source.y + "A" + 
		                        dr + "," + dr + " 0 0,1 " + 
		                        d.target.x + "," + 
		                        d.target.y;
		                });

		                node
		                    .attr("transform", function(d) { 
		                    return "translate(" + d.x + "," + d.y + ")"; });
		            }

		            });

		        </script>
		    </div>
		<!-- </div> -->
	</body>

</html>
